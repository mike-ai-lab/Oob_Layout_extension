<!-- sample.html - beginning HTML for the ruby2javascript piece --><html><head>
		<title>Oob plugin</title>
		<!--<meta http-equiv="Content-Type" content="text/html; charset=gb2312">-->
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta http-equiv="MSThemeCompatible" content="Yes">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!--
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		-->
		
		 
		<!-- Jquery, in case of offline use-->
		<script src="./js/jquery.min.js"></script>
		<!-- Bootstrap core CSS -->
		<link href="./dist/css/bootstrap.min.css" rel="stylesheet">
		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--  [if lt IE 9]>-->
		<script src="./js/html5shiv.js"></script>
		<script src="./js/respond.min.js"></script>
		<!--<![endif]-->
	<link href="data:text/css;charset=utf-8," data-href="../dist/css/bootstrap-theme.min.css" rel="stylesheet" id="bs-theme-stylesheet"><link href="../assets/css/docs.min.css" rel="stylesheet"><script src="../assets/js/ie8-responsive-file-warning.js"></script><script src="../assets/js/ie-emulation-modes-warning.js"></script></head>

<!-- Optional Bootstrap Theme -->


<!-- Documentation extras -->




	
<body leftmargin="5" topmargin="5" marginwidth="5" marginheight="5">
<font size="2" face="Arial, Helvetica, sans-serif"> 


<div class="container">
<div class="row">

&nbsp;
<br>
	<!--<div class="col-xs-3 ">
		 <label class="pull-right" for="sel1">Select a preset</label>
	</div>-->
	<div class="col-xs-8">
	<form role="form">
		<!--<div class="form-group" id="parentOfPresetSelect">-->
		<div id="parentOfPresetSelect">
			<!-- PRESETS -->
			<select class="form-control" id="selectPreset" onchange="selectPreset(this.value)">
				<!--<select id="selectPreset">-->
				<option>Select a preset</option>
			</select>     
		
		</div>
	  </form>
	</div>
	<div class="col-xs-2">
		<!-- NEW PRESET -->
		<button title="Create a new preset" type="button" onclick="saveCurrentPreset(3)" class="btn btn-info">
			<span class="glyphicon glyphicon-plus"></span>
		</button>
	</div>
	<div class="col-xs-2">
		<!-- DELETE PRESET -->
		<button title="Delete curent preset" type="button" onclick="deleteCurrentPreset(3)" class="btn btn-default">
			<span class="glyphicon glyphicon-trash"></span>
		</button>
	</div>
</div> <!-- row -->
</div> <!-- container -->

<div class="container">
<div class="row">
	<div class="col-xs-3">
		<img src="./images/Oob1.png" width="120" height="116">
	</div>
	<div class="col-xs-9">
		<!-- LENGTH -->
		<div class="btn-group">
			<button class="btn btn-info" type="button" onclick="" style="width:120px">
				<span class="glyphicon glyphicon-resize-horizontal"></span> 
				<span id="label2"> Length </span>
			</button>
			<div class="btn-group" title="Single value or value1;value2;value3;...">
				<input type="text" size="4" class="form-control" placeholder="0.0" id="input2" onkeydown="return submitenter(this,event);">	
			</div>
			<div class="btn-group">
			
			&nbsp;&nbsp;
			</div>
			<button class="btn btn-default" type="button" onclick="" title="Random factor (0.0 > 1.0)">
				<span class="glyphicon glyphicon-stats"></span>&nbsp;
			</button>
			<div class="btn-group">
				<input type="text" size="1" class="form-control" placeholder="0.0" id="inputrand2" onkeydown="return submitenter(this,event);" title="Random factor (0.0 > 1.0)">
			</div>
		</div>
		<br><br>
		<!-- HEIGHT -->
		<div class="btn-group">
			<button class="btn btn-info" type="button" onclick="" style="width:120px"><span class="glyphicon glyphicon-resize-vertical"></span> <span id="label3"> Height </span></button>
			<div class="btn-group" title="Single value or value1;value2;value3;...">
				<input type="text" size="4" class="form-control" placeholder="0.0" id="input3" onkeydown="return submitenter(this,event);">	
				<input type="hidden" id="input3_storage" name="input3_storage" />
			</div>
			<div class="btn-group">
			
			&nbsp;&nbsp;
			</div>
			<button class="btn btn-default" type="button" onclick="" title="Random factor (0.0 > 1.0)">
				<span class="glyphicon glyphicon-stats"></span>&nbsp;</button>
			<div class="btn-group" title="Random factor (0.0 > 1.0)">
				<input type="text" size="1" class="form-control" placeholder="0.0" id="inputrand3" onkeydown="return submitenter(this,event);">
			</div>
		</div>
		<br><br>
		<!-- THICKNESS -->
		<div class="btn-group">
			<button class="btn btn-info" type="button" onclick="" style="width:120px"><span class="glyphicon glyphicon-resize-full"></span> <span id="label4"> Thickness </span></button>
			<div class="btn-group">
				<input type="text" size="4" class="form-control" placeholder="0.0" id="input4" onkeydown="return submitenter(this,event);">	
			</div>
			<div class="btn-group">
			
			&nbsp;&nbsp;
			</div>
			<button class="btn btn-default" type="button" onclick="" title="Random factor (0.0 > 1.0)"><span class="glyphicon glyphicon-stats"></span>&nbsp;</button>
			<div class="btn-group">
				<input type="text" size="1" class="form-control" placeholder="0.0" id="inputrand4" onkeydown="return submitenter(this,event);" title="Random factor (0.0 > 1.0)">
			</div>
		</div>
	</div>

</div><!-- row -->
<br>
<div class="row">
	<div class="col-xs-3">
		<img src="./images/Oob2.png" width="120" height="116">
	</div>
	<div class="col-xs-9">
		<div class="btn-group">
			<button class="btn btn-info" type="button" onclick="" style="width:120px">
				<span class="glyphicon glyphicon-fullscreen"></span> 
				<span id="label5"> Space length </span> 
			</button>
			<div class="btn-group">
				<input type="text" size="4" class="form-control" placeholder="0.0" id="input5" onkeydown="return submitenter(this,event);">	
			</div>	
			<div class="btn-group">
				&nbsp;&nbsp;
			</div>
			<!-- 5.1.6 Length offset -->
			<button class="btn btn-default" type="button" onclick="" title="Length offset"><span class=" glyphicon glyphicon-resize-full"></span>&nbsp;</button>
			<div class="btn-group">
				<input type="text" size="1" class="form-control" placeholder="0.0" id="inputlengthoffset" onkeydown="return submitenter(this,event);" title="Length offset">
			</div>
		</div>
		<br><br>
		<div class="btn-group">
			<button class="btn btn-info" type="button" onclick="" style="width:120px"><span class="glyphicon glyphicon-fullscreen"></span> <span id="label6">  Space height </span></button>
			<div class="btn-group">
				<input type="text" size="4" class="form-control" placeholder="0.0" id="input6" onkeydown="return submitenter(this,event);">	
			</div>	
			<div class="btn-group">
				&nbsp;&nbsp;
			</div>
			<!-- 5.1.6 Height offset -->
			<button class="btn btn-default" type="button" onclick="" title="Height offset"><span class=" glyphicon glyphicon-resize-full"></span>&nbsp;</button>
			<div class="btn-group">
				<input type="text" size="1" class="form-control" placeholder="0.0" id="inputheightoffset" onkeydown="return submitenter(this,event);" title="Height offset">
			</div>
		</div>
		<br><br>
		<!-- Joint Depth -->
		<div class="btn-group">
			<button class="btn btn-info" type="button" onclick="" style="width:120px">
				<span class="glyphicon glyphicon-sort"></span>
				<span id="label7">  Thickness</span> </button>
			<div class="btn-group">
				<input type="text" size="4" class="form-control" placeholder="0.0" id="input7" onkeydown="return submitenter(this,event);">	
			</div>	
			<div class="btn-group">
				&nbsp;&nbsp;
			</div>
			<!-- 5.1.6 Depth offset -->
			<button class="btn btn-default" type="button" onclick="" title="Depth offset"><span class=" glyphicon glyphicon-resize-full"></span>&nbsp;</button>
			<div class="btn-group">
				<input type="text" size="1" class="form-control" placeholder="0.0" id="inputlayeroffset" onkeydown="return submitenter(this,event);" title="Depth offset">
			</div>
		</div>
		<br><br>
		<!-- Row offset -->
		<div class="btn-group">
			<button class="btn btn-info" type="button" onclick="" style="width:100px">
				<span class="glyphicon glyphicon-transfer"></span>
				<span id="label8">Offset </span>
			</button>
			<div class="btn-group">
				<input type="text" size="3" class="form-control" placeholder="0.0" id="input8" onkeydown="return submitenter(this,event);">	
			</div>	
			<div class="btn-group">
				&nbsp;&nbsp;
			</div>
			
			<!--<button class="btn btn-default" type="button" onclick=""><span class="glyphicon glyphicon-align-left"></span></button>
			<button class="btn btn-default" type="button" onclick=""><span class="glyphicon glyphicon-align-center"></span></button>
			<button class="btn btn-default" type="button" onclick=""><span class="glyphicon glyphicon-align-right"></span></button>
			-->
			<div class="btn-group" data-toggle="buttons">
				  <label id="labeloption1" class="btn btn-default active" title="Start from left" onclick="setRadioValue(1);">
					<input type="radio" name="options" id="option1" checked=""><span class="glyphicon glyphicon-align-left"></span>&nbsp;
				  </label>
				  <label id="labeloption2" class="btn btn-default" title="Start from center" onclick="setRadioValue(2);">
					<input type="radio" name="options" id="option2"><span class="glyphicon glyphicon-align-center"></span>&nbsp;
				  </label>
				  <label id="labeloption3" class="btn btn-default" title="Start from right" onclick="setRadioValue(3);">
					<input type="radio" name="options" id="option3"><span class="glyphicon glyphicon-align-right"></span>&nbsp;
				  </label>
			</div>

<!-- Pattern Rotation Control -->
<div class="btn-group" style="margin-top:10px;">
  <label for="patternRotation">Pattern Direction:</label>
  <select class="form-control" id="patternRotation" style="width:auto; display:inline-block; margin-left:10px;">
	<option value="horizontal">Horizontal</option>
	<option value="vertical">Vertical</option>
  </select>
</div>

<!-- Start From Top/Bottom Control -->
<div class="btn-group" style="margin-top:10px;">
  <label for="startFrom">Start From:</label>
  <select class="form-control" id="startFrom" style="width:auto; display:inline-block; margin-left:10px;">
	<option value="bottom">Bottom</option>
	<option value="top">Top</option>
  </select>
</div>

<!-- Force Full Row as First Row -->
<div class="checkbox" style="margin-top:10px;">
  <label><input type="checkbox" id="forceFullRow" value="false" onchange="this.value = this.checked;"> Force Full Row as First Row</label>
</div>

<!-- Starting Row Height Control -->
<div class="btn-group" style="margin-top:10px;">
  <label for="startRowHeight">Starting Row Height:</label>
  <select class="form-control" id="startRowHeight" style="width:auto; display:inline-block; margin-left:10px;">
    <!-- Options will be populated by JavaScript -->
  </select>
</div>

<!-- Last Row Placement Control -->
<div class="btn-group" style="margin-top:10px;">
  <label for="lastRowPlacement">Last Row Placement:</label>
  <select class="form-control" id="lastRowPlacement" style="width:auto; display:inline-block; margin-left:10px;">
	<option value="cut">Cut to Face Bounds</option>
	<option value="full">Full Piece (may extend past face bounds)</option>
  </select>
</div>
		</div>
			<input type="text" id="inputstartpoint" value="1" style="display:none;"><!-- style="display:none;">-->
		<br><br>
	</div> 
<br>
<!-- COLOR -->
<div class="row">
	<div class="col-xs-3">
		<img src="./images/Oob3.png" width="120" height="30">
	</div>
	<!--<div class="col-xs-4">
		<div class="input-group input-group-sm">
			<span class="input-group-addon" id="label9">Color name</span>
			<input type="text" class="form-control" placeholder="Blue" id="input9" onKeyDown="return submitenter(this,event);">		
		</div>
		
	</div>-->
	<div class="col-xs-9">
		<div class="btn-group">
			<button class="btn btn-info" type="button" onclick="" style="width:120px">
				<span class="glyphicon glyphicon-tint"></span>  
				<span id="label9"> Color <span>
			</span></span></button>
			<div class="btn-group">
				<input type="text" size="9" class="form-control" placeholder="0.0" id="input9" onkeydown="return submitenter(this,event);">	
			</div>	
			<div class="btn-group">
			&nbsp;&nbsp;
			</div>
			<button class="btn btn-default" type="button" onclick="" title="Number of colors ( > 2.0) + Random factor (0.0 > 1.0)"><span class="glyphicon glyphicon-stats"></span>&nbsp;</button>
			<div class="btn-group">
				<input type="text" size="1" class="form-control" placeholder="0.0" id="inputrand5" onkeydown="return submitenter(this,event);" title="Number of colors ( > 2.0) + Random factor (0.0 > 1.0)">
			</div>
		</div>
	</div>

</div> 
<div class="row ">
	<div class="col-xs-11 pull-right">
		<br>
		  <button type="button" onclick="button_clicked(1)" class="btn btn-info"><span class="glyphicon glyphicon-cog"></span>  <label id="label10">Appliquer</label></button>&nbsp;
		  <button type="button" onclick="button_clicked(2)" class="btn btn-info"><span class="glyphicon glyphicon-ok"></span><label id="label11">&nbsp;OK</label></button>&nbsp;
		  <button type="button" onclick="button_clicked(3)" class="btn btn-default"><span class="glyphicon glyphicon-remove"></span><label id="label12">&nbsp; Annuler</label></button>
	</div><!-- col -->
</div><!-- row -->
</div><!-- container -->

 

 
  
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="./dist/js/bootstrap.min.js"></script>
 <!--<script src="../../assets/js/docs.min.js"></script>-->

 
 <script type="text/javascript">
 
	// Clear des options depuis ruby
	//=====================================
	function clearPresetOption(){
		// Fill options of presets selector V4.6
		var selectitem = document.getElementById("selectPreset");
		//alert( labelString );
		if (selectitem) {
			selectitem.options.length = 0;
		}
	}
	// Ajout de preset depuis ruby
	//==============================
	function addPresetOption(msg){
		// Fill options of presets selector V4.6
		var selectitem = document.getElementById("selectPreset");
		//alert( labelString );
		if (selectitem) {
			selectitem.options[selectitem.options.length] = new Option(msg,msg); 
		}
	}
	
	// Sauvegarde d'un nouveau preset
	//==================================
	function saveCurrentPreset()
	{
		rubyCalled( 'savepreset', 'true');
	}
	
	// Suppression du preset en cours
	//==================================
	function deleteCurrentPreset()
	{
		var result = $('#selectPreset').val();
		rubyCalled( 'deletepreset', result);
	}
	
	// Call back sur select
	//============================
	//parentOfPresetSelect
	$(function() {
		//$('#selectPreset').change(function(){
		//$('body').on('change','#selectPreset',function(){
		$('#selectPreset').on('change',function(){
			var result = $(this).val();
			//alert(result);
			rubyCalled('selectpreset', result);
			//alert(result);
		});
	});
	
	// @dialogOobOne.execute_script( 'setPreset( "'+@@s_presetname+'" );' ) # V6.0.0
	//=============================
	function setPreset(presetName)
	{
		//rubyCalled('selectpreset', presetName); a verifier avant de re activer (d  clenche des undo intempestifs
		//alert(presetName);
		
	}
	
	// Callback sur enter
	///====================================
	function submitenter(myfield,e)
	{
		
		var keycode;
		if (window.event) 
			keycode = window.event.keyCode;
		else 
			if (e) 
				keycode = e.which;
			else 
				return true;
		
		//alert(keycode);
		if (keycode == 13)
		   {
		   // FIX: Call button_clicked on enter for consistency
		   button_clicked(1); // 1 = Apply
		   return false;
		   }
		else
		   return true;
	}

	function rubyCalled( cb_name, msg ) {
		fake_url = 'skp:' + cb_name + '@' + msg
		//alert( fake_url);
		window.location.href = fake_url
	}
	
    // *** FIXED FUNCTION ***
    // This now only sends the action flag (1, 2, or 3).
    // The Ruby script is responsible for getting all element values.
	function button_clicked(flag) {
		rubyCalled( 'calcul', flag.toString());
	}
	
    function messageFromSketchUp(msg) {
        alert('SketchUp returned "' + msg + '"');
        var reg = new RegExp("[;]+", "g");
        var tableau = msg.split(reg);
        // This function seems to be for a different purpose, leaving as is.
        if(document.getElementById("text3")) document.getElementById("text3").value = tableau[0] || '';
        if(document.getElementById("text4")) document.getElementById("text4").value = tableau[1] || '';
        if(document.getElementById("text6")) document.getElementById("text6").value = tableau[3] || '';
        if(document.getElementById("text7")) document.getElementById("text7").value = tableau[4] || '';
        if(document.getElementById("textGisMaxi")) document.getElementById("textGisMaxi").value = tableau[6] || '';
        OnColorValuehandler && OnColorValuehandler();
    }
		
	// Call back sur radio buttons	
	function setRadioValue(val){
		//alert(val);
		document.getElementById("inputstartpoint").value = val;
	}
	// Compute par code ruby
	function compute(msg){
		//alert("");
		rubyCalled( 'calcul', 'true');
	}

	function setLabel(msg){
		<!-- alert( msg );  -->
		var tableau=msg.split(';');
		var label = tableau[0]; // attention c'est en dur, p-e faire une fonction plus intelligente (comme logiciel)
		var labelString = tableau[1];
		var item = document.getElementById(label);
		//alert( labelString );
		if (item) {
			item.innerHTML = labelString
		}
		
	}

	function setButtonLabel(msg){
		var tableau=msg.split(';');
		var label = tableau[0]; // attention c'est en dur, p-e faire une fonction plus intelligente (comme logiciel)
		var labelString = tableau[1];
		var item = document.getElementById(label);
		alert( item );
		if (item) {
			alert( item );
			item.value = labelString
		}
	}
	function setValue(msg){
		
		var tableau=msg.split(';');
		var label = tableau[0]; // attention c'est en dur, p-e faire une fonction plus intelligente (comme logiciel)
		//if(label == "input3") alert(tableau[1]);
		var labelString = tableau[1].replace(/#/g,";"); // #2 multi values
		//if(label == "input3") alert(labelString);
		var item = document.getElementById(label)
		if (item) {
			//			alert( msg );
			item.value = labelString
		}
		
		if(label == "inputstartpoint"){
			
			if(labelString == "1")	{
				$('#labeloption1').addClass('active');
				$('#labeloption2').removeClass('active');
				$('#labeloption3').removeClass('active');
			}
			if(labelString == "2") {
				$('#labeloption1').removeClass('active');
				$('#labeloption2').addClass('active');
				$('#labeloption3').removeClass('active');
			}
			if(labelString == "3"){
				//alert("radio set value"+labelString);
				$('#labeloption1').removeClass('active');
				$('#labeloption2').removeClass('active');
				$('#labeloption3').addClass('active');
			}
		}
		//document.getElementById("button").value = 'test'
	}
	function setCheckValue(msg){
		
		var tableau=msg.split(';');
		var label = tableau[0]; // attention c'est en dur, p-e faire une fonction plus intelligente (comme logiciel)
		var labelString = tableau[1];
		var item = document.getElementById(label)
		if (item) {
			if (labelString == "false"){
				item.checked = false;
				item.value = "false";
				//alert( msg ); 
			}
			else{
				item.checked = true;
				item.value = "true";
				//alert( msg ); 
			}
		}
		//document.getElementById("button").value = 'test'
	}
	function onCheckChange(){
		  //$(this).change(function(){
		valeurCoche = document.getElementById("input10").checked;  
		//alert(valeurCoche);
		if (valeurCoche){
			document.getElementById("input10").value = "true";
			//alert( "true" ); 
		} else{
			document.getElementById("input10").value = "false";
			//$(this).val("false");
			//alert( "false" ); 
		}
		 // });
	}
</script>

<script>
// Starting Row Height Control - Properly handles semicolon-separated values
$(document).ready(function() {
    
    function updateStartRowHeightDropdown() {
        console.log('Updating dropdown...');
        
        // Get the height input value
        var heightValue = $('#input3').val();
        console.log('Height value:', heightValue);
        
        if (!heightValue || heightValue.trim() === '') {
            console.log('No height value, clearing dropdown');
            $('#startRowHeight').empty();
            return;
        }
        
        // Split by semicolon and clean up values
        var heightValues = heightValue.split(';')
            .map(function(val) { return val.trim(); })
            .filter(function(val) { return val !== '' && val !== '0' && val !== '0.0'; });
        
        console.log('Height values array:', heightValues);
        
        var dropdown = $('#startRowHeight');
        var currentSelection = dropdown.val();
        
        // Clear and repopulate dropdown
        dropdown.empty();
        
        if (heightValues.length > 0) {
            heightValues.forEach(function(value) {
                dropdown.append('<option value="' + value + '">' + value + '</option>');
            });
            
            // Restore previous selection if it still exists
            if (heightValues.indexOf(currentSelection) !== -1) {
                dropdown.val(currentSelection);
            } else {
                dropdown.val(heightValues[0]); // Select first value
            }
        }
        
        console.log('Dropdown updated with', heightValues.length, 'options');
    }
    
    // Update dropdown when height input changes
    $('#input3').on('input keyup change', function() {
        console.log('Input3 changed');
        updateStartRowHeightDropdown();
    });
    
    // Handle dropdown selection change
    $('#startRowHeight').on('change', function() {
        var selectedValue = $(this).val();
        console.log('Dropdown selection changed to:', selectedValue);
        
        if (!selectedValue) return;
        
        // Get current height values
        var heightValue = $('#input3').val();
        if (!heightValue || heightValue.trim() === '') return;
        
        var heightValues = heightValue.split(';')
            .map(function(val) { return val.trim(); })
            .filter(function(val) { return val !== '' && val !== '0' && val !== '0.0'; });
        
        // Remove selected value from its current position
        heightValues = heightValues.filter(function(val) { return val !== selectedValue; });
        
        // Add selected value to the beginning
        heightValues.unshift(selectedValue);
        
        // Update input3 with new order (semicolon-separated)
        $('#input3').val(heightValues.join(';'));
        
        console.log('Updated input3 to:', heightValues.join(';'));
        
        // Update dropdown to reflect new order
        updateStartRowHeightDropdown();
    });
    
    // Initial population
    updateStartRowHeightDropdown();
    
    console.log('Starting Row Height control initialized');
});
</script>



</div></font></body><!-- Bootstrap core JavaScript
  ================================================== --><!-- Placed at the end of the document so the pages load faster --></html><!-- end ofOobOne.html -->